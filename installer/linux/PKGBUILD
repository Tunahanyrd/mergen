# Maintainer: Tunahanyrd <tunahanyrd@gmail.com>
pkgname=mergen
pkgver=0.9.3
pkgrel=1
pkgdesc="Multi-threaded download manager with browser integration and stream support (HLS/DASH)"
arch=('x86_64')
url="https://github.com/Tunahanyrd/mergen"
license=('GPL3')
depends=('glibc' 'gcc-libs' 'zlib' 'hicolor-icon-theme' 'ffmpeg')

package() {
    # All files are already in the build directory (copied by CI workflow)
    # No source array needed!
    
    install -Dm755 "${startdir}/mergen" "${pkgdir}/usr/bin/mergen"
    
    install -Dm644 "${startdir}/mergen.desktop" "${pkgdir}/usr/share/applications/mergen.desktop"
    
    install -Dm644 "${startdir}/mergen.png" "${pkgdir}/usr/share/icons/hicolor/128x128/apps/mergen.png"
    
    mkdir -p "${pkgdir}/usr/share/mergen"
    cp -r "${startdir}/browser-extension" "${pkgdir}/usr/share/mergen/"
    cp -r "${startdir}/native-host" "${pkgdir}/usr/share/mergen/"
    
    # Browser Extension Auto-Install
    install -Dm644 "${startdir}/mergen-browser-extension.crx" "${pkgdir}/usr/share/mergen/browser-extension.crx"
    
    # Chrome External Extension Config
    install -Dm644 "${startdir}/jahgeondjmbcjleahkcmegfenejicoeb.json" "${pkgdir}/usr/share/google-chrome/extensions/jahgeondjmbcjleahkcmegfenejicoeb.json"
    
    # Chromium External Extension Config
    install -Dm644 "${startdir}/jahgeondjmbcjleahkcmegfenejicoeb.json" "${pkgdir}/usr/share/chromium/extensions/jahgeondjmbcjleahkcmegfenejicoeb.json"
}